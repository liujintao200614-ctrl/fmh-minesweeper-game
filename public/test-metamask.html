<!DOCTYPE html>
<html>
<head>
    <title>MetaMask è¿æ¥æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>ğŸ¦Š MetaMask è¿æ¥æµ‹è¯•</h1>
    
    <div id="status"></div>
    
    <button onclick="checkMetaMask()">æ£€æŸ¥ MetaMask</button>
    <button onclick="connectWallet()">è¿æ¥é’±åŒ…</button>
    <button onclick="getAccounts()">è·å–è´¦æˆ·</button>
    
    <div id="log"></div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        function checkMetaMask() {
            log('ğŸ” æ£€æŸ¥ MetaMask...', 'warning');
            
            if (typeof window.ethereum !== 'undefined') {
                log('âœ… window.ethereum å­˜åœ¨', 'success');
                log(`ğŸ”§ isMetaMask: ${window.ethereum.isMetaMask}`, 'info');
                log(`ğŸ”§ ç‰ˆæœ¬: ${window.ethereum.version || 'unknown'}`, 'info');
                
                if (window.ethereum.isMetaMask) {
                    log('âœ… MetaMask å·²æ£€æµ‹åˆ°!', 'success');
                } else {
                    log('âš ï¸ æ£€æµ‹åˆ°é’±åŒ…ä½†ä¸æ˜¯ MetaMask', 'warning');
                }
            } else {
                log('âŒ æœªæ£€æµ‹åˆ° MetaMask', 'error');
                log('è¯·ç¡®ä¿å·²å®‰è£… MetaMask æ‰©å±•', 'error');
            }
        }

        async function connectWallet() {
            log('ğŸ”„ å°è¯•è¿æ¥é’±åŒ…...', 'warning');
            
            if (typeof window.ethereum === 'undefined') {
                log('âŒ MetaMask æœªå®‰è£…', 'error');
                return;
            }

            try {
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                
                log(`âœ… è¿æ¥æˆåŠŸ! è´¦æˆ·: ${accounts[0]}`, 'success');
                
                // è·å–ç½‘ç»œä¿¡æ¯
                const chainId = await window.ethereum.request({
                    method: 'eth_chainId'
                });
                log(`ğŸŒ å½“å‰ç½‘ç»œ: ${chainId} (${parseInt(chainId, 16)})`, 'info');
                
            } catch (error) {
                log(`âŒ è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                log(`é”™è¯¯ä»£ç : ${error.code}`, 'error');
            }
        }

        async function getAccounts() {
            log('ğŸ“‹ è·å–å·²è¿æ¥è´¦æˆ·...', 'warning');
            
            if (typeof window.ethereum === 'undefined') {
                log('âŒ MetaMask æœªå®‰è£…', 'error');
                return;
            }

            try {
                const accounts = await window.ethereum.request({
                    method: 'eth_accounts'
                });
                
                if (accounts.length > 0) {
                    log(`âœ… å·²è¿æ¥è´¦æˆ·: ${accounts[0]}`, 'success');
                } else {
                    log('âš ï¸ æ²¡æœ‰å·²è¿æ¥çš„è´¦æˆ·', 'warning');
                }
                
            } catch (error) {
                log(`âŒ è·å–è´¦æˆ·å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', () => {
            log('ğŸš€ é¡µé¢åŠ è½½å®Œæˆ', 'info');
            checkMetaMask();
        });
    </script>
</body>
</html>